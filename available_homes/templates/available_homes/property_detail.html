{% extends "_base.html" %}
{% load static %}

{% block title %}
<title>{{ object.location }} | TrustBuild Urban</title>
{% endblock %}
{% block content %}
<div class="bg-white font-sans text-texts pt-24 lg:pt-28">
    <!-- Sticky Sub-Nav (Desktop Only) -->
    <nav class="sticky top-[76px] lg:top-[84px] z-40 bg-white border-b border-gray-200 hidden lg:block">
        <div class="max-w-7xl mx-auto px-6 flex items-center space-x-8 h-14 text-[11px] font-bold uppercase tracking-widest text-texts/60">
            <a href="#overview" class="text-texts border-b-2 border-texts h-full flex items-center">Overview</a>
            <a href="#about" class="hover:text-texts transition-colors h-full flex items-center">About This Home</a>
            <a href="#details" class="hover:text-texts transition-colors h-full flex items-center">Property Details</a>
            <a href="#neighborhood" class="hover:text-texts transition-colors h-full flex items-center">Neighborhood</a>
        </div>
    </nav>

    <!-- Main Content Container -->
    <main class="max-w-7xl mx-auto px-4 sm:px-6 py-4">
        
        <!-- Image Gallery Grid (Exact Redfin Layout: 1 Large Left, 2 Stacked Right) -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-2 mb-8 rounded-xl overflow-hidden h-[300px] md:h-[550px]">
            <!-- Main Image -->
            <div class="h-full">
                {% if object.cover %}
                <img src="{{ object.cover.get_image_url }}" alt="{{ object.title }}" class="w-full h-full object-cover">
                {% else %}
                <div class="w-full h-full bg-gray-100 flex items-center justify-center text-gray-400">No Image Available</div>
                {% endif %}
            </div>
            <!-- Stacked Right Images -->
            <div class="grid grid-rows-2 gap-2 h-full">
                {% for img in object.images.all|slice:':2' %}
                <div class="h-full overflow-hidden{% if forloop.last and object.images.count > 2 %} relative group cursor-pointer{% endif %}">
                    <img src="{{ img.get_image_url }}" class="w-full h-full object-cover" alt="{{ object.title }}">
                    {% if forloop.last and object.images.count > 2 %}
                    <div class="absolute inset-0 bg-black/30 flex items-center justify-center text-white font-bold text-lg">
                        <div class="border-2 border-white px-6 py-2 rounded-lg bg-black/40">{{ object.images.count }} photos</div>
                    </div>
                    {% endif %}
                </div>
                {% empty %}
                <div class="h-full bg-gray-100"></div>
                <div class="h-full bg-gray-100"></div>
                {% endfor %}
            </div>
        </div>

        <div class="flex flex-col lg:flex-row gap-12">
            <!-- Left Column: Content -->
            <div class="lg:w-[70%]">
                <!-- Header Info (Exact Redfin Re-alignment) -->
                <div id="overview" class="mb-10 pb-10 border-b border-gray-100 flex flex-col md:flex-row justify-between gap-8">
                    <div class="flex-grow">
                        <div class="flex items-center space-x-2 text-green-700 font-bold text-[10px] uppercase tracking-widest mb-4 bg-green-50 w-fit px-3 py-1 rounded-full">
                            <span class="w-2 h-2 rounded-full bg-green-600 animate-pulse"></span>
                            <span>{{ object.get_status_display_custom|upper }}</span>
                        </div>
                        
                        <div class="flex items-baseline space-x-4 mb-4">
                            <h1 class="text-4xl md:text-5xl font-black text-texts tracking-tight leading-none">{{ object.price }}</h1>
                        </div>

                        <div class="flex items-center space-x-6 mb-6">
                            <div class="flex items-baseline space-x-1">
                                <span class="text-3xl font-bold">{{ object.beds|default:"—" }}</span>
                                <span class="text-[11px] font-bold uppercase tracking-wider text-gray-500">bd</span>
                            </div>
                            <div class="w-px h-8 bg-gray-200"></div>
                            <div class="flex items-baseline space-x-1">
                                <span class="text-3xl font-bold">{{ object.baths|default:"—" }}</span>
                                <span class="text-[11px] font-bold uppercase tracking-wider text-gray-500">ba</span>
                            </div>
                            <div class="w-px h-8 bg-gray-200"></div>
                            <div class="flex items-baseline space-x-1">
                                <span class="text-3xl font-bold">{{ object.sqft|default:"—" }}</span>
                                <span class="text-[11px] font-bold uppercase tracking-wider text-gray-500">sq ft</span>
                            </div>
                        </div>

                        <div class="text-xl md:text-2xl font-bold text-texts/80">
                            {{ object.location }}
                        </div>
                    </div>

                    <!-- Mini Map Box Placeholder -->
                    <div class="hidden md:block w-56 h-36 rounded-2xl overflow-hidden border border-gray-200 relative group cursor-pointer shadow-sm">
                        <img src="https://images.unsplash.com/photo-1524661135-423995f22d0b?auto=format&fit=crop&w=400&q=80" class="w-full h-full object-cover grayscale opacity-60 group-hover:grayscale-0 group-hover:opacity-100 transition-all">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <div class="w-8 h-8 bg-accent rounded-full border-4 border-white shadow-xl animate-bounce"></div>
                        </div>
                    </div>
                </div>

                <!-- About section -->
                <section id="about" class="mb-12">
                    <h2 class="text-2xl font-serif font-black text-texts mb-8">About This Home</h2>
                    {% if object.description %}
                    <div class="prose prose-gray max-w-none text-texts/70 leading-relaxed mb-10 text-lg">
                        {{ object.description|linebreaks }}
                    </div>
                    {% endif %}
                    
                    <!-- Summary Highlights -->
                    {% if bedroom_info or bathroom_info or garage_and_parking_info %}
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
                        {% if bedroom_info %}
                        <div class="p-8 bg-gray-50/50 rounded-2xl border border-gray-100 flex flex-col items-center text-center space-y-4">
                            <div class="p-4 bg-white rounded-xl shadow-sm text-accent">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 20h20"/><path d="M7 20V8a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v12"/><path d="M7 12V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v8"/></svg>
                            </div>
                            <div>
                                <div class="font-bold text-lg text-texts leading-tight">{{ object.beds }} Bedrooms</div>
                                <div class="text-[10px] font-bold uppercase tracking-widest text-gray-400 mt-1">Bedrooms</div>
                            </div>
                        </div>
                        {% endif %}
                        {% if bathroom_info %}
                        <div class="p-8 bg-gray-50/50 rounded-2xl border border-gray-100 flex flex-col items-center text-center space-y-4">
                            <div class="p-4 bg-white rounded-xl shadow-sm text-accent">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"/></svg>
                            </div>
                            <div>
                                <div class="font-bold text-lg text-texts leading-tight">{{ object.baths }} Bathrooms</div>
                                <div class="text-[10px] font-bold uppercase tracking-widest text-gray-400 mt-1">Bathrooms</div>
                            </div>
                        </div>
                        {% endif %}
                        {% if garage_and_parking_info %}
                        <div class="p-8 bg-gray-50/50 rounded-2xl border border-gray-100 flex flex-col items-center text-center space-y-4">
                            <div class="p-4 bg-white rounded-xl shadow-sm text-accent">
                                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="1" y="3" width="22" height="18" rx="2" ry="2"/><line x1="1" y1="9" x2="23" y2="9"/></svg>
                            </div>
                            <div>
                                <div class="font-bold text-lg text-texts leading-tight">{% for item in garage_and_parking_info %}{% if forloop.first %}{{ item.value }}{% endif %}{% endfor %}</div>
                                <div class="text-[10px] font-bold uppercase tracking-widest text-gray-400 mt-1">Parking</div>
                            </div>
                        </div>
                        {% endif %}
                    </div>
                    {% endif %}
                </section>

                <!-- Property Details Section -->
                <section id="details" class="mb-12 pt-12 border-t border-gray-100">
                    <h2 class="text-2xl font-serif font-black text-texts mb-10 text-center md:text-left">Detailed Property Information</h2>
                    
                    <div class="space-y-8">
                        <!-- Interior Section -->
                        {% if bedroom_info or bathroom_info or kitchen_and_dining_info or interior_features_info %}
                        <div class="bg-white border border-gray-100 rounded-3xl p-6 md:p-8 shadow-sm">
                            <h3 class="text-xs font-black uppercase tracking-widest text-accent mb-8 flex items-center flex-wrap gap-y-4">
                                <span>Interior Highlights</span>
                                <span class="bg-gray-100 h-px flex-grow ml-0 md:ml-6 w-full md:w-auto"></span>
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">
                                {% include 'available_homes/details_parts/bedroom_information.html' %}
                                {% include 'available_homes/details_parts/bathroom_information.html' %}
                                {% include 'available_homes/details_parts/kitchen_and_dining.html' %}
                                {% include 'available_homes/details_parts/interior_features.html' %}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Heating & Cooling -->
                        {% if heating_and_cooling_info %}
                        <div class="bg-white border border-gray-100 rounded-3xl p-6 md:p-8 shadow-sm">
                            <h3 class="text-xs font-black uppercase tracking-widest text-accent mb-8 flex items-center flex-wrap gap-y-4">
                                <span>Climate Control</span>
                                <span class="bg-gray-100 h-px flex-grow ml-0 md:ml-6 w-full md:w-auto"></span>
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">
                                {% include 'available_homes/details_parts/heating_and_cooling.html' %}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Other Rooms -->
                        {% if other_rooms_info %}
                        <div class="bg-white border border-gray-100 rounded-3xl p-6 md:p-8 shadow-sm">
                            <h3 class="text-xs font-black uppercase tracking-widest text-accent mb-8 flex items-center flex-wrap gap-y-4">
                                <span>Additional Spaces</span>
                                <span class="bg-gray-100 h-px flex-grow ml-0 md:ml-6 w-full md:w-auto"></span>
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">
                                {% include 'available_homes/details_parts/other_rooms.html' %}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Parking & Exterior -->
                        {% if garage_and_parking_info or outdoor_spaces_info %}
                        <div class="bg-white border border-gray-100 rounded-3xl p-6 md:p-8 shadow-sm">
                            <h3 class="text-xs font-black uppercase tracking-widest text-accent mb-8 flex items-center flex-wrap gap-y-4">
                                <span>Parking & Exterior</span>
                                <span class="bg-gray-100 h-px flex-grow ml-0 md:ml-6 w-full md:w-auto"></span>
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">
                                {% include 'available_homes/details_parts/garage_and_parking.html' %}
                                {% include 'available_homes/details_parts/outdoor_spaces.html' %}
                            </div>
                        </div>
                        {% endif %}

                        <!-- Utilities & Green Energy -->
                        {% if utilities_and_green_energy_info %}
                        <div class="bg-white border border-gray-100 rounded-3xl p-6 md:p-8 shadow-sm">
                            <h3 class="text-xs font-black uppercase tracking-widest text-accent mb-8 flex items-center flex-wrap gap-y-4">
                                <span>Utilities & Green Energy</span>
                                <span class="bg-gray-100 h-px flex-grow ml-0 md:ml-6 w-full md:w-auto"></span>
                            </h3>
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 md:gap-10">
                                {% include 'available_homes/details_parts/utilities_and_green_energy.html' %}
                            </div>
                        </div>
                        {% endif %}
                    </div>
                </section>
            </div>

            <!-- Right Column: Sidebar (Sticky Sidebar Enhanced) -->
            <div class="lg:w-[30%]">
                <div class="sticky top-28 lg:top-40 space-y-8">
                    <!-- Action Card -->
                    <div class="p-8 border border-gray-100 rounded-[2.5rem] shadow-2xl bg-white relative overflow-hidden group">
                        <div class="absolute top-0 right-0 w-32 h-32 bg-accent/5 rounded-full -mr-16 -mt-16 blur-2xl transition-all group-hover:bg-accent/10"></div>
                        
                        <button class="w-full py-6 bg-[#E63946] text-white font-bold uppercase tracking-[0.2em] text-xs rounded-2xl shadow-xl hover:shadow-red-200 hover:-translate-y-1 transition-all mb-4 relative z-10">
                            Request showing
                        </button>
                        <button class="w-full py-6 border-2 border-texts text-texts font-bold uppercase tracking-[0.2em] text-xs rounded-2xl hover:bg-gray-50 hover:-translate-y-1 transition-all mb-10 relative z-10">
                            Start an offer
                        </button>
                        
                        <div class="pt-8 border-t border-gray-100 flex flex-col items-center space-y-4 relative z-10">
                           <a href="/contact" class="text-[11px] font-bold text-accent uppercase tracking-widest hover:text-secondary transition-colors">Ask a question</a>
                           <div class="h-1 w-1 rounded-full bg-gray-200"></div>
                           <a href="tel:7085782846" class="text-lg font-black text-texts tracking-tighter">(708) 578-2846</a>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>
</div>
{% endblock %}
