{% load i18n %}
<div class="ai-widget ai-widget-universal" data-field-type="{{ widget.ai_field_type }}">
    <div class="ai-widget-input-wrapper">
        <textarea{% include "django/forms/widgets/attrs.html" %} data-ai-field="true">{% if widget.value %}{{ widget.value }}{% endif %}</textarea>
    </div>
    <div class="ai-widget-controls">
        <button type="button" 
                class="ai-generate-btn"
                data-field-label="{{ widget.ai_field_label }}"
                data-help-text="{{ widget.ai_help_text }}"
                data-max-length="{{ widget.ai_max_length }}"
                data-field-type="{{ widget.ai_field_type }}"
                data-context-fields="{{ widget.ai_context_fields }}"
                data-loading-text="{{ widget.ai_loading_text }}">
            <span class="ai-btn-icon">‚ú®</span>
            <span class="ai-btn-text">{{ widget.ai_button_text }}</span>
            <span class="ai-btn-loading" style="display: none;">
                <span class="ai-spinner"></span>
                {{ widget.ai_loading_text }}
            </span>
        </button>
        {% if widget.ai_allow_custom_prompt %}
        <button type="button" class="ai-custom-prompt-btn" title="Add custom instructions">
            <span>üìù</span>
        </button>
        {% endif %}
        <span class="ai-status" style="display: none;"></span>
    </div>
    {% if widget.ai_allow_custom_prompt %}
    <div class="ai-custom-prompt-modal" style="display: none;">
        <div class="ai-modal-content">
            <div class="ai-modal-header">
                <span class="ai-modal-title">Custom Instructions</span>
                <button type="button" class="ai-modal-close">&times;</button>
            </div>
            <div class="ai-modal-body">
                <textarea class="ai-custom-prompt-input" 
                          placeholder="Enter specific instructions for content generation...&#10;&#10;Example: Write a description focusing on our transparent pricing model for diaspora clients."
                          rows="3"></textarea>
                <div class="ai-modal-hint">
                    <small>Tip: Be specific about tone, length, and key points to include.</small>
                </div>
            </div>
            <div class="ai-modal-footer">
                <button type="button" class="ai-modal-btn ai-modal-cancel">Cancel</button>
                <button type="button" class="ai-modal-btn ai-modal-generate">Generate</button>
            </div>
        </div>
    </div>
    {% endif %}
    {% if widget.ai_help_text %}
    <div class="ai-field-hint">
        <small>{{ widget.ai_help_text }}</small>
    </div>
    {% endif %}
</div>
